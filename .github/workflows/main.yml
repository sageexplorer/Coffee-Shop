name: db test
on: [workflow_dispatch]
jobs:
  test-container:
    runs-on: ubuntu-18.04
    container: ubuntu
    services:
      mydb:
        image: mysql:5.7
        ports: 
        - 32574:3306
        env:
          DB_DATABASE: ender.com
          DB_USER: root
          DB_PASSWORD: root
    steps:
          - name: Set up MySQL
            run: |
               apt update && apt install sudo
               apt-get update
               apt-get install -y mysql-client
               sudo /etc/init.d/mysql start
               mysql --host 127.0.0.1 --port 32574 -uroot -ppassword -e "SHOW DATABASES"
               mysql -e 'CREATE DATABASE ${{ env.DB_DATABASE }};' -u${{ env.DB_USER }} -p${{ env.DB_PASSWORD }}
